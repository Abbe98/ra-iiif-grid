var app=function(){"use strict";function t(){}function n(t){return t()}function e(){return Object.create(null)}function o(t){t.forEach(n)}function a(t){return"function"==typeof t}function i(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}let c,r;function l(t,n){return c||(c=document.createElement("a")),c.href=n,t===c.href}function s(t,n){t.appendChild(n)}function u(t,n,e){t.insertBefore(n,e||null)}function f(t){t.parentNode.removeChild(t)}function d(t){return document.createElement(t)}function p(t){return document.createTextNode(t)}function m(){return p(" ")}function h(t,n,e,o){return t.addEventListener(n,e,o),()=>t.removeEventListener(n,e,o)}function g(t,n,e){null==e?t.removeAttribute(n):t.getAttribute(n)!==e&&t.setAttribute(n,e)}function v(t,n){n=""+n,t.wholeText!==n&&(t.data=n)}function $(t,n){t.value=null==n?"":n}function b(t){r=t}function k(){if(!r)throw new Error("Function called outside component initialization");return r}function w(){const t=k();return(n,e,{cancelable:o=!1}={})=>{const a=t.$$.callbacks[n];if(a){const i=function(t,n,{bubbles:e=!1,cancelable:o=!1}={}){const a=document.createEvent("CustomEvent");return a.initCustomEvent(t,e,o,n),a}(n,e,{cancelable:o});return a.slice().forEach((n=>{n.call(t,i)})),!i.defaultPrevented}return!0}}const y=[],x=[],_=[],N=[],C=Promise.resolve();let E=!1;function M(t){_.push(t)}const O=new Set;let L=0;function F(){const t=r;do{for(;L<y.length;){const t=y[L];L++,b(t),S(t.$$)}for(b(null),y.length=0,L=0;x.length;)x.pop()();for(let t=0;t<_.length;t+=1){const n=_[t];O.has(n)||(O.add(n),n())}_.length=0}while(y.length);for(;N.length;)N.pop()();E=!1,O.clear(),b(t)}function S(t){if(null!==t.fragment){t.update(),o(t.before_update);const n=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,n),t.after_update.forEach(M)}}const B=new Set;let I;function j(){I={r:0,c:[],p:I}}function P(){I.r||o(I.c),I=I.p}function A(t,n){t&&t.i&&(B.delete(t),t.i(n))}function T(t,n,e,o){if(t&&t.o){if(B.has(t))return;B.add(t),I.c.push((()=>{B.delete(t),o&&(e&&t.d(1),o())})),t.o(n)}else o&&o()}function R(t){t&&t.c()}function K(t,e,i,c){const{fragment:r,on_mount:l,on_destroy:s,after_update:u}=t.$$;r&&r.m(e,i),c||M((()=>{const e=l.map(n).filter(a);s?s.push(...e):o(e),t.$$.on_mount=[]})),u.forEach(M)}function X(t,n){const e=t.$$;null!==e.fragment&&(o(e.on_destroy),e.fragment&&e.fragment.d(n),e.on_destroy=e.fragment=null,e.ctx=[])}function q(t,n){-1===t.$$.dirty[0]&&(y.push(t),E||(E=!0,C.then(F)),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}function z(n,a,i,c,l,s,u,d=[-1]){const p=r;b(n);const m=n.$$={fragment:null,ctx:null,props:s,update:t,not_equal:l,bound:e(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(a.context||(p?p.$$.context:[])),callbacks:e(),dirty:d,skip_bound:!1,root:a.target||p.$$.root};u&&u(m.root);let h=!1;if(m.ctx=i?i(n,a.props||{},((t,e,...o)=>{const a=o.length?o[0]:e;return m.ctx&&l(m.ctx[t],m.ctx[t]=a)&&(!m.skip_bound&&m.bound[t]&&m.bound[t](a),h&&q(n,t)),e})):[],m.update(),h=!0,o(m.before_update),m.fragment=!!c&&c(m.ctx),a.target){if(a.hydrate){const t=function(t){return Array.from(t.childNodes)}(a.target);m.fragment&&m.fragment.l(t),t.forEach(f)}else m.fragment&&m.fragment.c();a.intro&&A(n.$$.fragment),K(n,a.target,a.anchor,a.customElement),F()}b(p)}class D{$destroy(){X(this,1),this.$destroy=t}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(t){var n;this.$$set&&(n=t,0!==Object.keys(n).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function U(n){let e,o,a;return{c(){e=d("button"),e.textContent="◀",g(e,"class","svelte-akhr56")},m(t,i){u(t,e,i),o||(a=h(e,"click",n[3]),o=!0)},p:t,d(t){t&&f(e),o=!1,a()}}}function H(n){let e,o,a;return{c(){e=d("button"),e.textContent="▶",g(e,"class","svelte-akhr56")},m(t,i){u(t,e,i),o||(a=h(e,"click",n[4]),o=!0)},p:t,d(t){t&&f(e),o=!1,a()}}}function V(n){let e,o,a,i,c=n[1]&&U(n),r=n[2]&&H(n);return{c(){e=d("nav"),o=d("div"),c&&c.c(),a=d("span"),i=p(n[0]),r&&r.c(),g(a,"class","svelte-akhr56"),g(o,"class","svelte-akhr56"),g(e,"class","svelte-akhr56")},m(t,n){u(t,e,n),s(e,o),c&&c.m(o,null),s(o,a),s(a,i),r&&r.m(o,null)},p(t,[n]){t[1]?c?c.p(t,n):(c=U(t),c.c(),c.m(o,a)):c&&(c.d(1),c=null),1&n&&v(i,t[0]),t[2]?r?r.p(t,n):(r=H(t),r.c(),r.m(o,null)):r&&(r.d(1),r=null)},i:t,o:t,d(t){t&&f(e),c&&c.d(),r&&r.d()}}}function W(t,n,e){let{decade:o=1750}=n,{canNavigateBack:a}=n,{canNavigateForward:i}=n;const c=w();return t.$$set=t=>{"decade"in t&&e(0,o=t.decade),"canNavigateBack"in t&&e(1,a=t.canNavigateBack),"canNavigateForward"in t&&e(2,i=t.canNavigateForward)},[o,a,i,function(){c("navigation",{action:"previous"})},function(){c("navigation",{action:"next"})}]}class G extends D{constructor(t){super(),z(this,t,W,V,i,{decade:0,canNavigateBack:1,canNavigateForward:2})}}function J(n){let e;return{c(){e=d("div"),g(e,"class","spinner svelte-a7h3vc")},m(t,n){u(t,e,n)},p:t,i:t,o:t,d(t){t&&f(e)}}}class Q extends D{constructor(t){super(),z(this,t,null,J,i,{})}}function Y(n){let e,o,a,i,c;return{c(){e=d("div"),o=m(),a=d("div"),g(e,"id","background"),g(e,"class","svelte-109vcd7"),g(a,"id","modal"),g(a,"class","svelte-109vcd7")},m(t,r){u(t,e,r),u(t,o,r),u(t,a,r),i||(c=h(e,"click",n[0]),i=!0)},p:t,i:t,o:t,d(t){t&&f(e),t&&f(o),t&&f(a),i=!1,c()}}}function Z(t,n,e){let o,{isModalOpen:a}=n,{currentCanvas:i}=n;const c=w();let r;var l;return a&&(o="https://lbiiif.riksarkivet.se/"+i.split("/")[3]+"/info.json"),l=async()=>{console.log("onMount"),r=window.L.map("modal",{center:[0,0],attributionControl:!1,zoom:0,crs:window.L.CRS.Simple}),window.L.tileLayer.iiif(o).addTo(r)},k().$$.on_mount.push(l),function(t){k().$$.on_destroy.push(t)}((()=>{r.remove(),r=null})),t.$$set=t=>{"isModalOpen"in t&&e(1,a=t.isModalOpen),"currentCanvas"in t&&e(2,i=t.currentCanvas)},[function(){c("modal-close")},a,i]}class tt extends D{constructor(t){super(),z(this,t,Z,Y,i,{isModalOpen:1,currentCanvas:2})}}function nt(t,n,e){const o=t.slice();return o[22]=n[e],o}function et(n){let e,a,i,c,r,l,p,v;return{c(){e=d("form"),a=d("label"),a.textContent="IIIF Manifest",i=m(),c=d("input"),r=m(),l=d("button"),l.textContent="Ladda",g(a,"for","iiif-input"),g(c,"id","iiif-input"),g(c,"type","url"),g(c,"placeholder","https://lbiiif.riksarkivet.se/collection/arkiv/8XCsKmH8XKATnPaXVPaWf2"),g(l,"type","submit")},m(t,o){var f;u(t,e,o),s(e,a),s(e,i),s(e,c),$(c,n[4]),s(e,r),s(e,l),p||(v=[h(c,"input",n[14]),h(e,"submit",(f=n[9],function(t){return t.preventDefault(),f.call(this,t)}))],p=!0)},p(t,n){16&n&&$(c,t[4])},i:t,o:t,d(t){t&&f(e),p=!1,o(v)}}}function ot(n){let e,o;return e=new Q({}),{c(){R(e.$$.fragment)},m(t,n){K(e,t,n),o=!0},p:t,i(t){o||(A(e.$$.fragment,t),o=!0)},o(t){T(e.$$.fragment,t),o=!1},d(t){X(e,t)}}}function at(n){let e,o,a=n[2],i=[];for(let t=0;t<a.length;t+=1)i[t]=it(nt(n,a,t));return{c(){e=d("div"),o=d("div");for(let t=0;t<i.length;t+=1)i[t].c();g(o,"class","container svelte-7p2a12"),g(e,"class","container-background svelte-7p2a12")},m(t,n){u(t,e,n),s(e,o);for(let t=0;t<i.length;t+=1)i[t].m(o,null)},p(t,n){if(4100&n){let e;for(a=t[2],e=0;e<a.length;e+=1){const c=nt(t,a,e);i[e]?i[e].p(c,n):(i[e]=it(c),i[e].c(),i[e].m(o,null))}for(;e<i.length;e+=1)i[e].d(1);i.length=a.length}},i:t,o:t,d(t){t&&f(e),function(t,n){for(let e=0;e<t.length;e+=1)t[e]&&t[e].d(n)}(i,t)}}}function it(t){let n,e,o,i,c,r,p,v;return{c(){n=d("button"),e=d("img"),c=m(),l(e.src,o=t[22].image)||g(e,"src",o),g(e,"alt",i=t[22].title),g(e,"class","svelte-7p2a12"),g(n,"title",r=t[22].title),g(n,"class","svelte-7p2a12")},m(o,i){u(o,n,i),s(n,e),s(n,c),p||(v=h(n,"click",(function(){a(t[12](t[22].image))&&t[12](t[22].image).apply(this,arguments)})),p=!0)},p(a,c){t=a,4&c&&!l(e.src,o=t[22].image)&&g(e,"src",o),4&c&&i!==(i=t[22].title)&&g(e,"alt",i),4&c&&r!==(r=t[22].title)&&g(n,"title",r)},d(t){t&&f(n),p=!1,v()}}}function ct(t){let n,e;return n=new tt({props:{currentCanvas:t[1],isModalOpen:t[0]}}),n.$on("modal-close",t[13]),{c(){R(n.$$.fragment)},m(t,o){K(n,t,o),e=!0},p(t,e){const o={};2&e&&(o.currentCanvas=t[1]),1&e&&(o.isModalOpen=t[0]),n.$set(o)},i(t){e||(A(n.$$.fragment,t),e=!0)},o(t){T(n.$$.fragment,t),e=!1},d(t){X(n,t)}}}function rt(t){let n,e,o,a,i,c,r,l,h,$,b=t[10]&&function(t){let n,e;return n=new G({props:{decade:t[5],canNavigateBack:t[6],canNavigateForward:t[7]}}),n.$on("navigation",t[11]),{c(){R(n.$$.fragment)},m(t,o){K(n,t,o),e=!0},p(t,e){const o={};32&e&&(o.decade=t[5]),64&e&&(o.canNavigateBack=t[6]),128&e&&(o.canNavigateForward=t[7]),n.$set(o)},i(t){e||(A(n.$$.fragment,t),e=!0)},o(t){T(n.$$.fragment,t),e=!1},d(t){X(n,t)}}}(t);const k=[at,ot,et],w=[];function y(t,n){return t[2].length>0?0:t[8]?1:2}r=y(t),l=w[r]=k[r](t);let x=t[0]&&ct(t);return{c(){n=d("main"),e=d("nav"),o=d("h1"),a=p(t[3]),i=m(),b&&b.c(),c=m(),l.c(),h=m(),x&&x.c(),g(e,"class","svelte-7p2a12")},m(t,l){u(t,n,l),s(n,e),s(e,o),s(o,a),s(e,i),b&&b.m(e,null),s(n,c),w[r].m(n,null),s(n,h),x&&x.m(n,null),$=!0},p(t,[e]){(!$||8&e)&&v(a,t[3]),t[10]&&b.p(t,e);let o=r;r=y(t),r===o?w[r].p(t,e):(j(),T(w[o],1,1,(()=>{w[o]=null})),P(),l=w[r],l?l.p(t,e):(l=w[r]=k[r](t),l.c()),A(l,1),l.m(n,h)),t[0]?x?(x.p(t,e),1&e&&A(x,1)):(x=ct(t),x.c(),A(x,1),x.m(n,null)):x&&(j(),T(x,1,1,(()=>{x=null})),P())},i(t){$||(A(b),A(l),A(x),$=!0)},o(t){T(b),T(l),T(x),$=!1},d(t){t&&f(n),b&&b.d(),w[r].d(),x&&x.d()}}}function lt(t,n,e){let o,a=!1,i=[],c=[];let r,l=[];function s(t){fetch(t).then((t=>t.json())).then((n=>{l.length||(e(3,r=n.label.sv[0]),document.title=r),"Manifest"==n.type&&function(t){let n,o,a,r;t.metadata.forEach((t=>{"Titel"==t.label.sv[0]?n=t.value.none[0]:"Källhänvisning"==t.label.sv[0]?o=t.value.none[0]:"Datering"==t.label.sv[0]&&(a=t.value.none[0],4!=a.length||isNaN(a)?9!=a.length||"-"!=a[4]||isNaN(a.substring(0,4))||isNaN(a.substring(5,9))?r=null:10*Math.floor(parseInt(a.substring(0,4))/10)==10*Math.floor(parseInt(a.substring(5,9))/10)&&(r=10*Math.floor(parseInt(a.substring(0,4))/10)):r=10*Math.floor(parseInt(a)/10))})),t.items.forEach((t=>{if("Canvas"==t.type){let l=t.id.replace("/canvas","/square/350,/0/default.jpg"),s=t.id.replace("/canvas","").replace("https://lbiiif.riksarkivet.se/arkis!","https://sok.riksarkivet.se/bildvisning/");i.push({title:n,source:o,date:a,image:l,link:s,decade:r}),e(2,c=i)}}))}(n),l.push(t);for(let t of n.items)l.includes(t.id)||("Manifest"==t.type||"Collection"==t.type)&&s(t.id)}))}let u,f=new URLSearchParams(window.location.search).get("manifest");f?f.split(",").forEach((t=>s(t))):r="Riksarkivet";let d,p,m,h=new URLSearchParams(window.location.search).get("date"),g=0;var v;function $(){e(2,c=i.filter((t=>t.decade===g))),e(6,p=d[d.indexOf(g)-1]),e(7,m=d[d.indexOf(g)+1])}v=()=>{if(h){d=[...new Set(i.map((t=>t.decade)))].sort();const t=d[Math.floor(d.length/2)];b||e(5,g=t),$()}else e(2,c=i)},k().$$.before_update.push(v);let b=!1;return[a,o,c,r,u,g,p,m,f,function(){u.split(",").forEach((t=>s(t))),window.history.pushState({},"",`?manifest=${u}`)},h,function(t){const n=t.detail.action;b=!0,e(5,g="previous"==n?p:m),$()},function(t){e(1,o=t),e(0,a=!0)},function(){e(0,a=!1)},function(){u=this.value,e(4,u)}]}return new class extends D{constructor(t){super(),z(this,t,lt,rt,i,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
